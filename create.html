<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Créer ton Défi</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="fade-in">
  <div class="container">
    <h2>🧠 Crée ton défi</h2>
    <div id="questions"></div>
    <button id="finishBtn">Terminer</button>

    <div id="shareSection" class="hidden">
      <p>Partage ton lien 👇</p>
      <input type="text" id="shareLink" readonly>
      <div class="socials">
        <a id="whatsapp" target="_blank">📱 WhatsApp</a>
        <a id="facebook" target="_blank">📘 Facebook</a>
        <a id="twitter" target="_blank">🐦 Twitter</a>
      </div>
    </div>
  </div>

  <script>
    const questions = [
      { q: "Ton plat préféré ?", options: ["Pizza", "Burger", "Riz", "Pâtes"] },
      { q: "Ton sport préféré ?", options: ["Football", "Basket", "Tennis", "Natation"] },
      { q: "Ton animal préféré ?", options: ["Chien", "Chat", "Oiseau", "Lion"] },
      { q: "Ta couleur préférée ?", options: ["Rouge", "Bleu", "Noir", "Vert"] },
      { q: "Ton rêve le plus fou ?", options: ["Voyager", "Être riche", "Célébrité", "Dormir"] },
    ];

    const qContainer = document.getElementById("questions");
    questions.forEach((q, i) => {
      qContainer.innerHTML += `
        <div class="question-block">
          <p>${q.q}</p>
          ${q.options.map(opt => `
            <label><input type="radio" name="q${i}" value="${opt}"> ${opt}</label>
          `).join("")}
        </div>`;
    });

    document.getElementById("finishBtn").addEventListener("click", () => {
      let answers = {};
      questions.forEach((_, i) => {
        const selected = document.querySelector(`input[name="q${i}"]:checked`);
        answers[i] = selected ? selected.value : "";
      });

      const name = localStorage.getItem("creatorName");
      const uid = localStorage.getItem("uid");

      localStorage.setItem(`answers_${uid}`, JSON.stringify(answers));

      const shareURL = `${window.location.origin}${window.location.pathname.replace("create.html","play.html")}?uid=${uid}&user=${encodeURIComponent(name)}`;
      document.getElementById("shareLink").value = shareURL;
      document.getElementById("shareSection").classList.remove("hidden");

      document.getElementById("whatsapp").href = `https://wa.me/?text=${encodeURIComponent("🔥 Viens deviner les réponses de " + name + " ! " + shareURL)}`;
      document.getElementById("facebook").href = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareURL)}`;
      document.getElementById("twitter").href = `https://twitter.com/intent/tweet?url=${encodeURIComponent(shareURL)}&text=🔥 Défi de ${name}`;
    });
  </script>
</body>
</html>